
# 无线区块链系统中的共识实验（[论文](./../Blockchain_in_Wireless_Networks/papers/Wireless_Algorithms_Systems_And_Applications_p568(D.Yu&etal,%20Book,%202020).pdf)）

【描述：（一）实验目标，（二）实验方案（详细的实验方案，包括实验环境、实验步骤等），（三）技术难点（目前的技术难点、还需要补充的知识等）。】

## 一、实验目标

测试单跳无线区块链系统中，作者提出的共识算法在不同节点数量下和不同当选冗余首领节点数量下达成共识所需的共识时长和共识错误率。

## 二、实验方案

### 2.1 仿真内容

* **无线区块链网络仿真**：
  * 搭建一个无线网络；
  * 节点可以生成交易数据、区块数据和消息数据等，节点间进行通信，在本地建立数据库，记录不同节点的地址以及各节点的数据类型等；
  * 在不同节点之间传输数据（不同大小、不同数量）。
  * 设置无线网络节点传输概率和传输功率
  
* **区块链共识算法仿真**：
  * 实现通信证明（PoC）共识算法达成共识
  * 首领节点选举
  * 区块生成
  * 区块验证
  * 区块链更新

### 2.2 系统设计

#### 2.2.1 节点设计

节点的主要功能有
* 生成节点ID、路由表、本地IP、本地区块链等初始化数据结构；
* 提供更新路由表、下载邻居节点的区块链；
* 处理广播消息。

创世节点启动流程
* 当一个节点在启动加入网络后ping过预先定义的节点后发现路由表为空；
* 节点新建区块链；
* 该节点创造一个新的交易，从特殊节点获取若干币；
* 该节点开始挖矿，加交易打包进创世区块
* 创世节点启动完毕，开始监听各种消息，根据命令输入发出相应消息

其他节点启动过程如下：
* 请求更新路由表
* 向邻居节点发送拉取区块链的消息，对收到的区块链进行长度的比较，保留最长的链，并序列化到本地

#### 2.2.2 共识算法设计

共识算法模拟流程如下：
* 所有共识节点启动完毕之后，新开一个线程，执行挖矿逻辑
* 某个节点获取出块权限后，从未处理交易池中将交易排序，并打包到生成的区块中；
* 节点将区块广播后，监听信道若没有多个首领节点，则更新区块链，开始新一轮共识。否则将重新发送新的区块；
* 节点接收到区块后，验证区块的有限性，若是有效，则更新区块链，否则丢弃当前区块；
* 开心新一轮的共识。

#### 2.2.3 参数设置

* **节点数量**：$N$个节点；
* **网络区域**：$100m\times 100m$，节点之间的最小距离为$1m$；
* **传输参数设置**：节点的传输概率为 $p_v$，节点的传输功率为 $P_v$是从一个区间中随机选择，确保任何一对节点都可以在无线网络中相互接收消息。
节点状态：首领状态，候选者状态、挖矿状态。

## 三、代码设计

### 3.1 节点数据结构

### 3.2 交易数据结构

### 3.3 区块数据结构

### 3.4 网络

### 3.5 共识算法
# 测试的指标

## 稳定度

### 定义

记 $T_{v}$ 为无线网络节点 $v$ 在区块链系统中的活跃时间，所有共识节点的剩余活动时间之和为 $\sum_{i \in N}T_{i}$，定义节点的活动时间比为 $\rho_{v} = \frac{T_{v}}{\sum_{i \in N}T_{i}}$。记 $r_{v}=\frac{N_{v}}{K}$ 为节点在最近 $K$ 个确认区块中参与共识比值，其中，$N_{v}$ 是节点 $v$ 生成区块的数量。定义无线网络节点 $v$ 的稳定度为 
$$S_{v}=\alpha\times \rho_{v}+\beta\times r_{v}$$
其中，权重系数 $\alpha, \beta$ 可根据偏好设置。在区块链系统运行初期，确认区块数量不足 $K$ 个时记节点的共识比 $r_{v}=0$，此时节点的稳定度主要受节点的活动时间的影响。

### 测试

影响稳定度主要因素有：节点活动时间比和共识比。这两者会对所选节点的稳定度产生影响，但是所占的权重还不能确定。节点的剩余活动时间会逐渐减少，如果节点的活动时间不曾延长，选举剩余活动时间比小的节点可能会导致生成空区块，降低交易处理的效率。出块节点的选举算法的思想，出块节点应该尽可能是稳定和可信的，确保能够生成有效区块，并在完成区块确认之前不会出现故障。所以需要选择一个优质的节点作为出块节点是非常重要的。为了确定权重系数，需要对不同的权重系数做多次对比实验。

实验场景设置：区块链网络中有 $N$ 个节点，其中 $\frac{N}{4}$ 个节点具有较大的活动时间占比和较小共识比；$\frac{N}{4}$ 个节点具有较小的活动时间占比和较大共识比；$\frac{N}{4}$ 个节点具有较小的活动时间占比和较小共识比；$\frac{N}{4}$ 个节点具有较大的活动时间占比和较大共识比。每个共识结束之后都需要更换出块节点。

对于权重系数 $\alpha, \beta$ 的实验我们分别测试了以下几种情况进行实验：
* $\alpha = 1, \beta = 0$:
* $\alpha = 0, \beta = 1$:
* $\alpha = 0.5, \beta = 0.5$:
* $\alpha = 0.9, \beta = 0.1$:
* $\alpha = 0.1, \beta = 0.9$:

我们通过多次共识中，优质节点（活动时间占比高且共识比高）被选中的次数来确定比较合理的权重系数。

## 时延测试

测试不同场景（节点数量、节点密度）下区块的确认时间。为了方便对照，需要对条件和变量进行控制。
* 每个区块设置相同的大小；
* 每个节点除了稳定度的指标不同，其他都相同；

通过实验测试在不同节点数量和节点密度时的共识的时延，并将多次实验的结果取平均值。

对于共识时延，我们测量不同网络节点数量时的情况：
* 网络大小 $N = 100$
* 网络大小 $N = 200$
* 网络大小 $N = 400$
* 网络大小 $N = 600$
* 网络大小 $N = 800$
* 网络大小 $N = 1000$

测试不同节点密度时的共识时延：
* 节点密度 $density = 0.2$：
* 节点密度 $density = 0.5$：
* 节点密度 $density = 0.1$：
* 节点密度 $density = 0.1.5$：
* 节点密度 $density = 2$：

## 吞吐量测试

测试不同场景（节点数量、节点密度）下交易处理的效率。为了方便对照，需要对条件和变量进行控制。
* 每个区块设置相同的大小，区块中交易的数量也相同；
* 每个节点除了稳定度的指标不同，其他都相同；
* 不考虑生成空区块的情形

通过实验测试在不同节点数量和节点密度时的共识的时延和交易数量，计算得到交易吞吐量，并将多次实验的结果取平均值。

对于交易吞吐量，我们测量不同网络节点数量时的情况：
* 网络大小 $N = 100$
* 网络大小 $N = 200$
* 网络大小 $N = 400$
* 网络大小 $N = 600$
* 网络大小 $N = 800$
* 网络大小 $N = 1000$

测试不同节点密度时的交易吞吐量：
* 节点密度 $density = 0.2$：
* 节点密度 $density = 0.5$：
* 节点密度 $density = 0.1$：
* 节点密度 $density = 0.1.5$：
* 节点密度 $density = 2$：

## 女巫攻击

测试节点发起女巫攻击时，共识时延和交易吞吐量的变化情况。测试节点数量固定时，不同数量的女巫节点对于协议性能指标共识时延和交易吞吐量的情况，进一步分析女巫攻击对系统性能的影响。
* 女巫节点占比 $10%$:
* 女巫节点占比 $20%$:
* 女巫节点占比 $30%$:
* 女巫节点占比 $40%$:
* 女巫节点占比 $50%$:

## 开销测试

共识协议中，算力开销主要是受到节点数量、节点接收消息成功率，区块生成时间的影响；通信开销主要受到节点数量、节点接收消息成功率、交易到达速率，区块生成时间的影响。

关于开销分析的部分主要是理论分析，可以得到一个理论结果，绘制理论曲线图。可以比较我们协议与比特币协议以及PBFT协议的优缺点。

### 算力开销

（仿真实验待补充）

### 通信开销

（仿真实验待补充）

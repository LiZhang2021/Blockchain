# Double-Spending Attack on Fast payment

## 2021年9月14日 11：30 am
1. 本文只考虑快速支付服务中双花攻击成功的概率，针对零确认交易进行分析，且只分析了在一跳的情况下，零确认交易受到双花攻击的概率，那么针对多跳的情形又该如何分析？
2. 对于受害者接收到TRv先于TRa的概率分析还应该考虑一下网络的通信协议，针对全连接为网络，且他们之间通过广播传输消息的情况，安全分析过程是否会有所差异？

## 2021年9月14日 11：00 am
快速支付服务将不需要被验证，切一半交易数额都比较小，主要针对低花费交易或零确认交易。那么对于快速支付服务的双花攻击又该如何抵抗？在此基础上，我你们首先要了解什么是双花攻击，定义出攻击的模型，在此基础上提出安全分析。
1. 攻击模型： 假设攻击者是装有比特币的设备。并且攻击者通过支付比特币来获取受害者的服务。并且假设攻击者控制部分网络节点，并且不能访问受害者的私钥。此外，攻击者直到受害者的IP地址，并且攻击者和其同谋者的算力少于系统中总诚实节点的算力。最后，假设攻击者使用的地址的集合并不能识别出攻击者，即攻击行为可以被检测，但攻击者标识不会被揭示。
2. 双花攻击成功的必要条件：
2.1 受害节点接收到交易TRv(攻击者与受害者的交易)要早于TRa（攻击者与自身的交易，这两个交易有相同的输入）；
2.2 最终攻击者与自身的交易TRa被确认在区块链上。
3. 安全分析
通过对两个必要条件成立的概率进行分析，最终得出双花攻击成功的概率。本文主要讨论了必要条件二成立的概率，必要条件1成立的概率并未做特别详细的分析推导。
4. 结论
双花攻击成功的概率受限于攻击者同谋的数量、受害者连接的数量，以及受害者接收两个交易的时差。

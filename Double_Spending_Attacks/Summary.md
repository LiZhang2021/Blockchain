# 区块链中双花攻击分析


在区块链领域，不管何种区块链系统都面临双花攻击的威胁。区块链中双花攻击会造成很大的经济损失。双花攻击是攻击者利用网络传输延时将相同的一笔钱花费两次，从而获得额外收益。区块链主要包含两种结构：一种是链式结构，通过哈希将区块连接起来形成链式结构；另一种是图结构，利用指针将交易链接成一个有向无环图结构。针对两种不同的结构的双花攻击成功的计算概率将有所不同。本文考虑在完美通信的情况下，不同区块链结构双花攻击成功的概率以及双双话攻击成功时的收益。

## 基于链式结构区块链的双花攻击分析

对于链式结构的区块链，通过将两个具有相同输入的交易打包到区块中，但是最终攻击交易被确认到区块链上实现双花攻击成功。对于这类区块链的双花攻击模型有一般的双花攻击模型和自适应的双花攻击模型。下面分别给出两种攻击模型的分析和计算。

### 一般双花攻击模型

1. 系统模型假设
    * 假设系统由 $N$ 个节点构成，并且节点可以随意加入网络；
    * 假设每个节点通过竞争生成区块，并达成一致添加到区块链主链上；
    * 假设节点在固定时期长度中生成区块，一个时期只能生成一个区块；
    * 系统中的节点可以分成两类：诚实节点和攻击者节点； 
    * 假设攻击节点决定发起双花攻击，会生成一个目标交易，随后生成一个攻击交易；
    * 当确定攻击成功时，攻击者会选择公布伪区块链。

#### 双花攻击成功概率计算

  *  假设攻击者在一个时期中生成区块的概率为$q$，诚实节点在一个时期中生成区块的概率为$p$，且有 $p + q = 1$。
  *  假设区块生成过程是一个泊松计数过程（随机过程），生成速率为 $\lambda$。
  *  记初始攻击时间为 $t = 0$，时间 $t$ 每增长 $1$，就生成一个区块。随着时间增长，欺诈链长度为 $F(t)$，诚实链长度为 $H(t)$。因此总区块增长数量为 $M(t) = H(t) + F(t) = \lambda \cdot t$，在 $t$ 时刻，诚实链与欺诈链的差额时一个随机游走的过程，可记作 $S(t) = H(t) - F(t)$。

#### 双花攻击成功收益计算


#### 双花攻击成功概率计算


#### 双花攻击成功收益计算


### 自适应双花攻击模型

#### 双花攻击成功概率计算


#### 双花攻击成功收益计算


#### 双花攻击成功概率计算


#### 双花攻击成功收益计算

## 基于DAG结构区块链的双花攻击分析


#### 双花攻击成功概率计算


#### 双花攻击成功收益计算



# 无线区块链系统论文实验

## 实验一（Consensus in Wireless Blockchain System(Q.Xu&etal, 2019)）

### 1.1 共识算法

针对单跳无线网络环境中的区块链系统，作者仿真测试了PoC共识算法的性能。主要测试在不同网络大小中选出单个首领和多个首领（主要由故障或敌手攻击造成）达成共识所用的时间。仿真中提出的协议的公平性和候选者降低可以验证理论分析的正确性。

* **首领节点选举**：根据无线网络节点之间竞争通信的特点，竞争信道的方式选举首领节点。
* **生成区块**：最早竞争成功的节点将获取出块权限，生成区块并广播。其他节点接收到区块后会验证出块节点的数量和区块有效性，验证失败则转发新的区块消息。
* **区块验证**：首领节点根据侦听的信号判定出块节点的数量。若存在多个首领节点，则其他节点会转发新的区块信息。
* **更新区块链**：若首领节点发现只有一个首领节点则更新区块链；否则出块节点发送新的区块消息，并丢弃原来的区块。其他节点侦听发现有新的区块消息则丢弃原来的区块；否则更新区块链。

### 1.2 参数设置

* **节点数量**：$N$个节点，激活矿工比例为 $\eta$；
* **网络区域**：$100m\times 100m$，节点之间的最小距离为$1m$；
* **环境噪声上界**：$\mathcal{N} = 1$；
* **故障模型设置**：假设由于故障或敌手攻击导致每个共识期当选的冗余首领数量服从期望为 $\lambda$的指数分布；
* **传输参数设置**：节点的传输概率为 $p_v = 0.2$，节点的传输功率为 $P_v$是从一个区间中随机选择，确保任何一对节点都可以在无线网络中相互接收消息。

### 1.3 协议性能测试

共识算法的性能度量是共识时长和共识错误率，主要影响因素有参与共识的节点数量、当选冗余首领节点的数量。

* 测试当矿工数量增加时，当选冗余节点数量 $\lambda$不变时，共识所需的轮数。
* 测试当矿工数量不变时，当选冗余节点数量 $\lambda$增加时，共识所需的轮数。
* 测试随着轮数的增加，当选冗余节点数量 $\lambda$不变时，候选首领节点的数量的情况。
* 测试随着轮数不变，当选冗余节点数量 $\lambda$降低时，候选首领节点的数量的情况。
* 测试实现共识次数增加时，参与共识的矿工数量不变时，错误率（$\frac{节点成为首领的次数-节点成为首领的期望}{节点实现共识的总次数}$）的情况。
* 测试实现共识次数不变时，参与共识的激活矿工数量增加时，错误率（$\frac{节点成为首领的次数-节点成为首领的期望}{节点实现共识的总次数}$）的情况。

## 实验二（Fault-Tolerant Consensus in Wireless Blockchain System(Y.Zou&etal, 2021)）

### 2.1 共识算法

在多代理无线网络中，作者提出容错的基于通信证明的容错共识算法，通过基于无线通信竞争方案和投票机制在区块链系统中达成共识。

* **首领节点选举**：根据节点保持候选者状态达到一定轮数来确定选中成为首领节点。选举 首领节点。
* **区块生成和验证**：最后一个首领节点会生成区块并广播。其他节点接收到区块后，会记录区块并计数。
* **区块链更新**：当节点记录区块的次数超过容错阈值之后，则每个节点会将新区块存入本地，更新局部区块链。

### 2.2 参数设置

* **节点数量**：$N$ 个矿工随机均匀的部署在无线区块链网络中
* **故障矿工的数量**：$f$
* **诚实矿工的数量**：$N-f$
* **环境噪声上界**：$\mathcal{N} = 1db$
* **传输参数**：节点的传输概率为 $p_v = 0.2$

### 2.3 协议性能测试

共识算法的性能主要通过共识时长来衡量，主要影响因素是节点的数量和容错率。

* 测试当矿工数量固定（较低）时，实现共识的轮数与容错率之间的关系；
* 测试当矿工数量固定（较高）时，实现共识的轮数与容错率之间的关系。

## 实验三 BLOWN:A Blockchain Protocol for Wireless Networks under Adversarial SINR(M.Xu&etal, Mar.2021)

### 3.1 共识算法

作者利用无线网络通信的特点，针对单跳无线网络环境提出一种信道证明的共识算法，提出针对敌手SINR模型下能够抵抗阻塞攻击、双花攻击、女巫攻击的无线区块链协议BLOWN。

* **首领选举**：根据无线网络通信信道特点，采用基于PoC(Proof of Channel)的特性，挑选出最早占用信道的节点作为首领节点。
* **交易收集**：在确定了首领之后，首领节点将收集其他节点将发送的交易。
* **区块最终化**：首领节点将接收到的交易排序打包并广播。其他节点接收到首领节点的区块消息之后，验证抽签结果和区块的有效性成功之后，将区块天骄到本地区块链中。

### 3.2 参数设置

仿真实验使用golang加密库，采用具有64字节私钥、32字节公钥和64字节的ed25519数字签名。抽签算法使用随机可验证签名算法实现。
* **网络区域大小**：$d\times d, d = 10, \sqrt{N}$ 的二维平面，其中 $N$ 是网络大小；
* **算法参数**：$\alpha = 4, \beta = 2, \theta = 2, P = \beta\theta(\sqrt{2}d)^\alpha, p_v = 0.1, T = 60, \epsilon = 0.3, \gamma = 0.1, w_v = 20, \tau = \frac{W}{2}, c = 10$；
* **设备参数**：所有实验都是在CentOS 7操作系统下进行的，该操作系统运行在一台配备Intel Xeon 3.4 GHz CPU、120 GB RAM和1 TB SATA硬盘驱动器的机器上。所有的结果均为100次的平均值。

### 3.3 协议性能测试

共识算法的性能通过共识时长和交易吞吐量衡量，影响因素为网络密度、网络大小、Jammers类型和数量、女巫攻击节点数量。共识算法分为两个阶段，每个阶段的时长组成共识时长。交易处理的吞吐量计算公式为 $Throughput = \frac{|txp_t|}{i\times 100\mu s + j \times 50\mu s}$，其中 $t = i + j $是一个时期的轮数， $i, j$ 是每个时期中两个阶段的轮数， $50\mu s$ 是 IEEE 802.11 设置的单位时隙长度。
* 测试一个时期中的聚合概率 $p_V = \sum_{v\in V}p_v$，初始 $p_V = N\times p_{\max}$，其中 $p_{\max}$ 是节点最大传输概率。
* 测试一个时期中两个阶段轮数的情况。
* 测试网络密度为 $1, d = \sqrt{N}$ 时，不同网络大小 $N$对时期长度、吞吐量大小的情况。
* 测试网络大小固定为 $N = 100, d = 10$ 时，不同密度时时期长度、吞吐量大小的情况。
* 测试协议的抗Jammer攻击$(1 - \epsilon)T$的情况。考虑两种Jammer类型：随机Jammers和爆发Jammers。测试在不同 $\epsilon$时，两种Jammers的时期轮数和吞吐量的情况。
* 测试在固定节点数量、密度和网络区域时，不同女巫攻击节点数量对时期轮数和吞吐量的影响情况。

## 实验四 wChain - A Fast Fault-Tolerant Blockchain Protocol for Multihop Wireless Networks(M.Xu&etal, 2021)

### 4.1 共识算法

作者根据SINR模型的无线网络的特性，构建一个Spanner网络拓扑选举首领节点。首领节点生成区块并达成区块共识，最终实现区块链技术在多跳无线网络上的应用。wChain协议主要是通过一个三段式快速容错算法实现区块链共识，确保系统中非故障节点具有相同的全局视图。该协议通过数据聚合、数据重聚合以及节点恢复机制来确保协议的高效性、容错性和安全性。
* **首领选举**：通过构建节点的Spanner骨架确定首领节点。数据可以从其他节点聚合到首领节点，从而完成当前任期的数据聚合过程。
* **wChain过程**包含三个阶段：Prepare、Cimmit以及Decide：
     * **Prepare阶段：** 当前首领节点聚合所有追随者节点的**视图消息**，从而了解最新视图。如果超过 $f$ 个追随者返回相同的视图给首领，则首领进入Commit阶段聚合交易；否则首领发送消息给追随者，**放弃**当前任期；
    * **Commit阶段：** 首领节点从各个追随者节点收集交易；
    * **Decide阶段：** 首领节点验证收集交易并排序打包到区块，随后将新块与视图更新信息一起发送到整个网络。接收到区块与视图信息的网络节点可以更新其本地区块链以获得最新视图。

### 4.2 参数设置

* **算法参数**：$\alpha = 3, \beta = 3, s = 100, \lambda' = 25, \mathcal{N} = 1, P = 2\mathcal{N}\beta 2^{i\alpha}$。节点的崩溃频率为 $1\%\times N$，其中 $N$ 是网络大小；
**设备参数**：仿真程序是用C语言编写的，所有实验都是在CentOS 7操作系统下进行的，该操作系统运行在一台配备Intel Xeon 3.4 GHz CPU、120 GB RAM和1 TB SATA硬盘驱动器的机器上。进行了20多次测试获得每个结果的平均值；
* **测试度量**：通过时期长度和吞吐量来估计性能。时期长度是一个时期中时隙的数量，吞吐量计算公式为 $Throughput = \frac{|txp_t|}{i\times 100\mu s + j \times 50\mu s}$，其中 $t = i + j $是一个时期的轮数， $i, j$ 是每个时期中两个阶段的轮数， $50\mu s$ 是 IEEE 802.11 设置的单位时隙长度。

### 4.3 协议性能测试

共识算法的性能通过共识时长和交易吞吐量来测量，影响因素有网络大小、通信骨架深度、信噪比参数。

* 测试网络大小和骨架深度对性能的影响：
  * 在$150\times150$的平面中，测试不同节点分布中网络大小对任期长度和吞吐量的影响情况。
  * 测试节点数量固定时，测试不同节点分布中骨架深度对任期长度和吞吐量的影响情况。
* 测试信噪比参数 $\alpha, \beta$对性能的影响：
  *  在$150\times150$的平面中，测试不同信噪比参数时网络大小对任期长度和吞吐量的影响情况。
  * 节点数量固定时，测试不同信噪比参数时中骨架深度对任期长度和吞吐量的影响情况。

## 实验五 A Fast Consensus for Permissioned Wireless Blockchains(Y.Zou&etal, 2021)

### 通信证明共识算法

作者采用真实的SINR模型来描述单跳无线信道中不可靠传输。基于SINR模型，提出一种高效的分布式随机共识算法。
* **首领选举**：将根据无线网路的通信情况，从区块链系统所有验证者中选出一名作为首领节点。
* **区块生成**：首领节点生成区块并且分发给所有其他节点。
* **区块验证**：接收到来自首领节点的区块后，其他节点会验证区块的有效性，并返回确认。
* **更新链**：首领节点收到足够的确认数量后，更新区块链。
  
### 参数设置

* **网络参数**： $N$ 个节点随机均匀分布在半径为 $100m$ 的原型区域中，节点之间最小间距为 $1m$
。环境噪声上界：$\mathcal{N} = 1db$。节点的传输半径为 $200m$
* **传输参数**：节点最大传输功率为 $P = 2\mathcal{N}\beta R^\alpha $
* **故障节点比例**：$\varsigma$

### 协议性能测试

快速PoC共识算法的性能通过共识时长来衡量，主要影响因素有网络大小、共识次数 $k$ 和共识阈值$\sigma$。
* 在不同的 $\varsigma, \sigma$下，分别测试网络大小 $N$、实现共识的数量$k$和实现 $k$次共识的轮数情况。


